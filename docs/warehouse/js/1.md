# æ‰‹æ’•ä»£ç 

> é™†ç»­ä¼šå®Œå–„æ¯ä¸ªæ–¹æ³•çš„è¾“å…¥è¾“å‡ºï¼ŒåŸºæœ¬å‚æ•°

## push <Badge type="tip" text="Js" vertical="middle" /> <Badge type="warning" text="Ts" vertical="middle" />

`push() `æ–¹æ³•å¯å‘æ•°ç»„çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›æ–°çš„é•¿åº¦ã€‚

```js
// by ä½™å…‰
Array.prototype._push = function () {
  const arr = this;
  const len = arr.length;
  const args = arguments;
  for (let i = 0; i < args.length; i++) {
    arr[len + i] = args[i];
  }
  return arr.length;
};

// by zy
Array.prototype._push = function () {
  const arr = this;
  const len = arr.length;
  for (let i = 0; i < arguments.length; i++) {
    arr[len + i] = arguments[i];
  }
  return arr.length;
};
```

Tsç‰ˆæœ¬

```ts
// ä½™å…‰
function _push(arr: Array<any>, ...arg: Array<any>) {
  const len = arr.length;
  for (let i = 0; i < arg.length; i++) {
    arr[len + i] = arg[i];
  }
  return arr.length;
}
```

æ€»ç»“ï¼šæ€è·¯åŸºæœ¬ä¸€è‡´ï¼Œéƒ½æ˜¯å°†å‚æ•°å¾ªç¯æ·»åŠ åˆ°æ•°ç»„çš„æœ«å°¾

## pop <Badge type="tip" text="Js" vertical="middle" />

`pop()`åˆ é™¤æ•°ç»„æœ€åä¸€é¡¹ï¼Œå¹¶è¿”å›è¢«åˆ é™¤çš„å€¼

```js
// by ä½™å…‰
Array.prototype._pop = function () {
  const arr = this;
  const res = arr[arr.length - 1];
  arr.length = arr.length - 1;
  return res;
};

// by zy
Array.prototype._pop = function () {
  const arr = this;
  const result = arr[arr.length - 1];
  arr.length = arr.length - 1;
  return result;
};
```

## Every <Badge type="tip" text="Js" vertical="middle" />

å¯¹æ•°ç»„æ¯é¡¹éƒ½è¿è¡Œä¼ å…¥çš„å‡½æ•°ï¼Œå¦‚æœå¯¹æ¯é¡¹å‡½æ•°éƒ½è¿”å› trueï¼Œåˆ™è¿™ä¸ªæ–¹æ³•è¿”å› true

```js
// by ä½™å…‰
Array.prototype._every = function (callback, target = this) {
  const arr = target;
  const len = arr.length;

  if (typeof callback != "function") {
    throw new Error(); // è¿™é‡Œå‚è€ƒzyçš„åˆ†æï¼Œæ·»åŠ å‚æ•°å…¼å®¹ä¼šæ¯”è¾ƒå¥½
  }
  if (len === 0) return []; // å¦‚æœä¸ºç©ºæ•°ç»„ï¼Œè¿”å›[]

  for (let i = 0; i < len; i++) {
    if (!callback(arr[i], i, arr)) {
      return false;
    }
  }
  return true;
};

// by zy
Array.prototype._every = function (cb, thisValue = this) {
  if (typeof cb != "function") {
    throw new Error();
  }
  if (thisValue.length == 0) {
    return true;
  }
  for (let i = 0; i < thisValue.length; i++) {
    if (!cb(thisValue[i], i, thisValue)) {
      return false;
    }
  }
  return true;
};
```

## some <Badge type="tip" text="Js" vertical="middle" />

å¯¹æ•°ç»„æ¯é¡¹éƒ½è¿è¡Œä¼ å…¥çš„å‡½æ•°ï¼Œå¦‚æœæœ‰ä¸€é¡¹è¿”å›`true`ï¼Œåˆ™è¿™ä¸ªæ–¹æ³•è¿”å›`true`

```js
// by ä½™å…‰
Array.prototype._some = function (callback, target = this) {
  const arr = target;
  const len = arr.length;

  if (len === 0) return []; // å¦‚æœä¸ºç©ºæ•°ç»„ï¼Œè¿”å›[]

  for (let i = 0; i < len; i++) {
    if (callback(arr[i], i, arr)) {
      return true;
    }
  }
  return false;
};

// by zy
Array.prototype._some = function (cb, thisValue = this) {
  if (typeof cb != "function") {
    throw new Error();
  }
  if (thisValue.length == 0) {
    return false;
  }
  for (let i = 0; i < thisValue.length; i++) {
    if (cb(thisValue[i], i, thisValue)) {
      return true;
    }
  }
  return false;
};
```

## filter <Badge type="tip" text="Js" vertical="middle" />

å¯¹æ•°ç»„æ¯é¡¹éƒ½è¿è¡Œä¼ å…¥çš„å‡½æ•°ï¼Œå‡½æ•°è¿”å› true çš„é¡¹ç»„æˆæ•°ç»„ä¹‹åè¿”å›ã€‚

```js
// by ä½™å…‰
Array.prototype._filter_ = function (callback, target = this) {
  const arr = target; // ä¿å­˜this
  const result = []; // è¿”å›æ–°æ•°ç»„
  const len = arr.length;

  if (len === 0) return []; // å¦‚æœä¸ºç©ºæ•°ç»„ï¼Œè¿”å›[]

  for (let i = 0; i < len; i++) {
    if (callback(arr[i], i, arr)) result.push(arr[i]); //å¦‚æœåˆ¤å®šæ¡ä»¶ä¸ºtrueï¼Œä¿å­˜è‡³æ–°æ•°ç»„
  }
  return result; // è¿”å›ç¬¦åˆæ¡ä»¶çš„ç»“æœ
};

// by zy
Array.prototype._filter = function (cb, thisValue = this) {
  const result = [];
  if (typeof cb != "function") {
    throw new Error();
  }
  if (thisValue.length == 0) {
    return [];
  }
  for (let i = 0; i < thisValue.length; i++) {
    if (cb(thisValue[i], i, thisValue)) {
      result.push(thisValue[i]);
    }
  }
  return result;
};
```

## forEach <Badge type="tip" text="Js" vertical="middle" />

å¯¹æ•°ç»„æ¯é¡¹éƒ½è¿è¡Œä¼ å…¥çš„å‡½æ•°ï¼Œæ— è¿”å›å€¼ã€‚

```js
// by ä½™å…‰
Array.prototype._forEach = function (callback, target = this) {
  const arr = target; // ä¿å­˜this
  const result = []; // è¿”å›æ–°æ•°ç»„
  const len = arr.length;

  if (len === 0) return []; // å¦‚æœä¸ºç©ºæ•°ç»„ï¼Œè¿”å›[]
  for (let i = 0; i < len; i++) {
    callback(arr[i], i, arr);
  }
  return; // è¿”å›undefined
};

// by zy
Array.prototype._forEach = function (cb, thisValue = this) {
  const result = [];
  if (typeof cb != "function") {
    throw new Error();
  }
  if (thisValue.length == 0) {
    return;
  }
  for (let i = 0; i < thisValue.length; i++) {
    cb(thisValue[i], i, thisValue);
  }
  return;
};
```

## æ·±æµ…æ‹·è´ <Badge type="tip" text="Js" vertical="middle" />

```js
// by zy
function shallowCopy(target) {
  if (typeof target === "object" && target != null) {
    const copy = target instanceof Array ? [] : {};
    for (let key in target) {
      if (target.hasOwnProperty(key)) {
        copy[key] = target[key];
      }
    }
    return copy;
  }
  return target;
}

function deepCopy(target) {
  if (typeof target === "object" && target != null) {
    const copy = target instanceof Array ? [] : {};
    for (let key in target) {
      if (target.hasOwnProperty(key)) {
        copy[key] =
          typeof target[key] === "object"
            ? deepClone(target[key])
            : target[key];
      }
    }
    return copy;
  }
  return target;
}

// by ä½™å…‰
function shallowCopy(target) {
  //
  if (typeof target === "object" && target != null) {
    const copy = target instanceof Array ? [] : {};
    for (let key in target) {
      if (target.hasOwnProperty(key)) {
        copy[key] = target[key];
      }
    }
    return copy;
  }
  return target;
}
```

## flat <Badge type="tip" text="Js" vertical="middle" />

**æè¿°**

flat() æ–¹æ³•ä¼šæŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éå†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸éå†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å›ã€‚

```js
// by ä½™å…‰
// é€’å½’æ–¹å¼
Array.prototype._flat = function (deep = 1) {
  // è·å–è°ƒç”¨è€…
  let arr = this;
  // æ‹å¹³å±‚æ•°æ ¡éªŒ
  if (deep < 1) return arr;
  //
  return arr.reduce(
    (prev, next, i, n) => [
      ...prev,
      ...(Array.isArray(next) ? next._flat(deep - 1) : [next]),
    ],
    []
  );
};

//zy
Array.prototype.myFlat = function (num = 1) {
  if (num < 0) return this;
  let arr = [];
  this.forEach((item) => {
    if (Array.isArray(item)) {
      arr = arr.concat(item.myFlat(--num));
    } else {
      arr.push(item);
    }
  });
  return arr;
};
```

## bind <Badge type="tip" text="Js" vertical="middle" />

**æè¿°**

> bind() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨`bind()`è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„`this`è¢«æŒ‡å®šä¸º`bind()`çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œå…¶ä½™å‚æ•°å°†ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ï¼Œä¾›è°ƒç”¨æ—¶ä½¿ç”¨ã€‚

```js
// by ä½™å…‰
Function.prototype._bind = function (context, ...arg) {
  var self = this;
  const fBound = function (...childArg) {
    return self.apply(context, arg.concat(childArg)); // æ‹¼æ¥å‚æ•°
  };
  fBound.prototype = this.prototype; // è¿æ¥åŸå‹é“¾
  return fBound;
};
//zy
Function.prototype.myBind = function (context = window, ...args) {
  const fn = this;
  let newFn = function (...secondArgs) {
    fn.call(this, ...args, ...secondArgs);
  };
  newFn.prototype = this.prototype;
  return newFn;
};
```

## call <Badge type="tip" text="Js" vertical="middle" />

ä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„ this å€¼å’Œå•ç‹¬ç»™å‡ºçš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°æ¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°

> ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†å‡½æ•°ä½“å†… this å¯¹è±¡çš„æŒ‡å‘
> ç¬¬äºŒä¸ªå‚æ•°åŠä»¥åä¸ºå‡½æ•°è°ƒç”¨çš„å‚æ•°

```js
// ä½™å…‰
Function.prototype._bind = function (obj, ...arg) {
  if (typeof this !== "function") {
    throw new Error("what is trying to be bound is not callable");
  }
  const obj = obj || window; // å¯ä»¥åœ¨å‚æ•°ä¸Šè®¾ç½®é»˜è®¤å€¼
  obj.func = this; // è¿™é‡Œæ¨èä½¿ç”¨Symbol

  const result = obj.func(...arg); // æ‰§è¡Œå‡½æ•°
  delete obj.func; // åˆ é™¤å‡½æ•°ï¼Œå½“åšä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿï½
  return result;
};
//zy
Function.prototype.myCall = function (context = window, ...args) {
  const key = Symbol(); // é˜²æ­¢è¦†ç›–åŸæœ‰å±æ€§
  context[key] = this;
  const result = context[key](...args);
  delete context[key];
  return result;
};
```

- Symbol å¯ä»¥é˜²æ­¢è¦†ç›–åŸæœ‰å±æ€§ ğŸ‘

## apply <Badge type="tip" text="Js" vertical="middle" />

> ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†å‡½æ•°ä½“å†… this å¯¹è±¡çš„æŒ‡å‘
> ç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°è°ƒç”¨çš„å‚æ•°æ•°ç»„

```js
// ä½™å…‰
Function.prototype._bind = function (obj = window, arg) {
  const key = Symbol();
  obj[key] = this; // å°†å‡½æ•°å˜æˆå¯¹è±¡çš„å†…éƒ¨å±æ€§
  const result = obj[key](...arg); // æ‰§è¡Œå‡½æ•°
  delete obj[key]; // åˆ é™¤å‡½æ•°ï¼Œå½“åšä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿï½
  return result;
};

//zy
Function.prototype.myApply = function (context = window, args) {
  const key = Symbol(); // é˜²æ­¢è¦†ç›–åŸæœ‰å±æ€§
  context[key] = this;
  const result = context[key](...args);
  delete context[key];
  return result;
};
```

## åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰

* å¦‚æœæ˜¯åŸºæœ¬ç±»å‹ï¼Œåˆ™ç›´æ¥åˆ¤æ–­
* å¦‚æœæ˜¯Dateç±»å‹ï¼Œåˆ™æ¯”è¾ƒæ—¶é—´æˆ³
* åˆ¤æ–­æ˜¯å¦æ˜¯nullæˆ–è€…undefined
* å¦‚æœæ˜¯å¼•ç”¨ç±»å‹åˆ™é€’å½’æ¯”è¾ƒæ¯ä¸€ä¸ªå±‚çº§çš„å€¼æ˜¯å¦ç›¸ç­‰

```js

```

## composeå‡½æ•°

* å¤åˆå‡½æ•°
* ä»–æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­ä½¿ç”¨è¾ƒå¤šçš„ä¸€ç§å†™æ³•, å®ƒæŠŠé€»è¾‘è§£è€¦åœ¨å„ä¸ªå‡½æ•°ä¸­ï¼Œé€šè¿‡composeçš„æ–¹å¼ç»„åˆå‡½æ•°, å°†å¤–éƒ¨æ•°æ®ä¾æ¬¡é€šè¿‡å„ä¸ªå‡½æ•°çš„åŠ å·¥ï¼Œç”Ÿæˆç»“æœã€‚

```js
function compose(...arg) {
    // ä¿å­˜å‚æ•°åˆ—è¡¨
    // æŒ‰å€’å™æ‰§è¡Œå¹¶è¿”å›ç»“æœä½œä¸ºä¸‹ä¸€æ¬¡çš„å‚æ•°
    return function(x) {
        return arg.reduceRight((p, f) => f(p), x)
    }
}

const add = (x) => x + x;
const mul = (x) => x * x;
const one = (x) => x + 1;

const newFunc = compose(add, mul, one)
console.log(newFunc(2)); // 18
```